{% extends 'basic.html' %} {% block title %}Index{% endblock title %}
 {% block style %}

 <style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap');
 

  
  .pcard{
    flex:0 0 auto;
   
    box-shadow:
     5px 6px 8px rgba(205, 205, 205, 0.864),
     -3px -3px 5px rgba(240, 234, 234, 0.823);
    }
  .pre-btn,
.nxt-btn {
  border: none;
  /* width: 5vw; */
  height: 100%;
  position: absolute;
  top: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(90deg, rgba(255, 255, 255, 0) 0%, #ffffff00 100%);
  cursor: pointer;
  z-index: 8;
  

}

.pre-btn {
  left: 0;
  transform: rotate(180deg);
}

.nxt-btn {
  right: 0;
}

.pre-btn img,
.nxt-btn img {
  opacity: 0.2;
}

.pre-btn:hover img,
.nxt-btn:hover img {
  opacity: 1;
}

.collection-container {
  width: 100%;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-gap: 10px;
}

.collection {
  position: relative;
}

.collection img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.collection p {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  color: #fff;
  font-size: 50px;
  text-transform: capitalize;
}

.collection:nth-child(3) {
  grid-column: span 2;
  margin-bottom: 10px;
}

   .container{
     padding-top: 70px;
   }
   .occe{
    font-weight: 70%;
   }
   .product {
    position: relative;
    overflow: hidden;
    padding: 20px;
  }
  
  .product-category {
    /* padding: 0 10vw; */
    font-size: 30px;
    font-weight: 500;
    margin-bottom: 40px;
    text-transform: capitalize;
  }
  
  .product-container {
    /* padding: 0 10vw; */
    display: flex;
    overflow-x: auto;
    scroll-behavior: smooth;
  }
  
  .product-container::-webkit-scrollbar {
    display: none;
  }
  
    .product-card {
      flex: 0 0 auto;
      width: 250px;
      height: 450px;
      margin-right: 40px;
    }
  
  .items{
    display:flex;
    flex-wrap:wrap;
  }
  .pimg{
    display: flex;
    width: 286px;
    height: 286px;
  }
  .card-img-top{
    margin: auto;
    padding: auto;
  }
  .carozels{
    display: flex;
    flex-wrap: wrap;
 
  }
  .rcarz{
    width: 50%;
    display: flex;
    flex-direction: column;
  }
  .rcarz1,.rcarz2{
    display: flex;
    justify-content: center;
  }
  
.apnaa{
 margin-right: 20px;
 
  /* box-shadow: 2px 2px 5px black; */
  /* filter: drop-shadow(30px 10px 4px #4444dd); */
}
.scc{
  margin: 5px;
    margin-bottom: 10px;
    border-radius: 10px;
    /* padding: 10px; */
    box-shadow: 0px 3px 12px 0 rgb(144 144 144 / 54%);
}
.lefc{
  margin-top: 15px;
  width: 50%;
  
}
.lefcinner{
  border-radius: 5px;
  filter: drop-shadow(2px 19px 15px rgb(161, 159, 159));
}
.mmval{
  margin: 0 5px 0 5px;
  font-weight: bold;
  color: #5c5c5c;
}
.mm{
  outline: none;
    border: 0;
    background-color: #ebecf0;
    text-shadow: 1px 1px 0 #fff;
    color: #61677c;
    font-weight: bold;
    box-shadow: -5px -5px 20px #fff, 2px 2px 10px #a3a4a9;
    /* transition: all 0.2s ease-in-out; */
    cursor: pointer;
    font-weight: 600;
}
.mm:hover{
  outline: none;
    border: 0;
    background-color: #ebecf0;
    text-shadow: 1px 1px 0 #fff;
    color: #61677c;
    font-weight: bold;
   
    box-shadow: -5px -5px 20px #fff, 2px 2px 10px #a3a4a9;
    /* transition: all 0.2s ease-in-out; */
    cursor: pointer;
    font-weight: 600;

}
.plus:focus,.minus:focus{
  outline: none;
    border: 0;
    background-color: #ebecf0;
    text-shadow: 1px 1px 0 #fff;
    color: #61677c;
    font-weight: bold;
   
    box-shadow: -5px -5px 20px #fff, 2px 2px 10px #a3a4a9;
    /* transition: all 0.2s ease-in-out; */
    cursor: pointer;
    font-weight: 600;
}
.plus:hover,.minus:hover{
  box-shadow: inset 2px 2px 5px 1px #bdbdbd;
  /* background-color: #ffffff; */


}
.cart{
  /**/
  outline: none;
  border: none;
  background-color: white;
}
.cart:hover{
}
#atc{
  box-shadow: 2px 2px 5px rgb(182, 182, 182);

  font-weight: 500;
  text-shadow: 1px 1px 3px rgb(3,61,128);

}
#atc:hover{
  box-shadow: inset 3px 2px 4px rgb(3, 61, 128);
}
.nowcard{
  /* box-shadow: 2px 2px 5px rgb(196, 196, 196) */
 box-shadow: inset 2px 2px 10px 1px rgb(213, 207, 207);
height: 80%;

}
.dd{
  display: flex;
  justify-content: space-between;
}
#searchtitle{
  font-size: 30px;
    font-weight: 650;
    color: #747474;
    
    margin-bottom: 40px;
    text-transform: capitalize;
}
.ccbtns{
  margin: 20px;
  width: 90px;
  box-shadow: 2px 2px 7px #5c5c5c;
  border-radius: 20px;
    color: #ffffff;
    font-weight: bold;
}
.jname,.pdot{
  font-family: 'Poppins', sans-serif;
  font-weight: 700;
  color: #555555;
}
.jpr{
 font-size: 110%;
  font-weight: 700;
  color: #555555eb;
}
.textblack{
  text-shadow: 1px 1px 2px #00000070;
}
.ocdiv1{
  display: flex;
}
.ocdiv{
  display: flex;
}
.cdb{
  width: 23px;
  height: 25px;
  cursor: pointer;
 }
.cdb:hover{
  box-shadow: 2px 2px 3px rgb(154, 154, 154),-1px -1px 3px rgb(154,154,154);
  border-radius: 4px;
}
.cdb:focus{
  filter: drop-shadow(1px 1px 4px grey);
}
.fd{
  display: flex;
  justify-content: space-between;
}
.ocbq{
  color: gray;
}
.ocbodyitms{
font-family: Josefin sans;
font-weight: bold;
}
.prodi{
 max-width: 15rem;
}
.ocdelete{
  width: 27px;
  height: 25px;
 outline: none;
 border: none;
}
 
@media (max-width:1000px){
    .carozels{
      flex-direction: column;
    }
    .rcarz{
      width: 100%;
      margin-top: 50px;
    }
    .lefc{
      width: 100%;
    }
  }
  
 </style>
 {% endblock style %} {% load static%} {% block body %}
<div class="container">
  <!-- <button onclick="location.href = '/';">Go</button>
  <button id="cb"></button> -->
  <section class="product" style="display: none;"> 
    <h2 class="product-category">Trending</h2>
    <button class="pre-btn"><img src="/static/arrow.png" alt=""></button>
    <button class="nxt-btn"><img src="/static/arrow.png" alt=""></button>
    <div class="product-container">
      {% for i in all %}

    <div class="pcard card m-3" style="width: 18rem">
      <a href="/products/{{i.id}}">
       <div class="pimg"> 
        <!-- <img src=" /media/{{i.image}}" class="prodi card-img-top" alt="img not found"/> -->
      <button id="dltpr{{i.id}}" class="dlttemp" style="display: none;"><img src="/static/trash1.png" alt="Ni" id="dltimgpr{{i.id}}" class="cdb" onclick="deleteitemc(this.id)"></button>

    </div>
    </a>
      <div class="card-body">
        <h5 class="card-title" id="snamepr{{i.id}}">{{i.product_name}}</h5>
        <!-- <h5 class="card-title" id="pricepr{{i.id}}">{{i.price}}</h5> -->
        <!-- <p class="card-text">{{i.product_desc}}</p> -->
        <!-- <span id="divpr{{i.id}}" class="divpr"></span> -->
           
        <!-- <div id="davpr{{i.id}}" class="divpr davpr">

        
          <button id="pr{{i.id}}" class="cart">
            <a href="#" id="atc" class="btn btn-primary" onclick="return false;">Add to Cart</a>
          </button></div>
        
        

          <div id="dovpr{{i.id}}" class="divpr dovpr" style="display: none;">
            <button id="minuspr{{i.id}}" class=" minus btn btn-success">- </button>
             <span id="valpr{{i.id}}"></span>
            <button id="pluspr{{i.id}}" class=" plus btn btn-success">+ </button>
              
           </div> -->

          
      </div>
    </div>
    {% endfor %} </div></section>

<hr style="width: 100vw;">
    <br>
    <h2 class="product-category" id="searchtitle">Seasonal Sale</h2>
  
    <div class="items">
  
      {% for i in products %}
  
      <div class="card m-3 nowcard" style="width: 18rem">
        <a href="/products/{{i.id}}">
          <div class="pimg">
          <img src=" /media/{{i.image}}" class="card-img-top prodi" alt="img not found"/> </div>
      
      </a>
        <div class="card-body">
          <div class="dd">
        
          <div class="d2">   
          
            
  
  <h5 id="jnamepr{{i.id}}" class="jname" style="display: flex;"></h5>
          <h5 class="card-title jpr" id="pricepr{{i.id}}">&#8377 {{i.price}}</h5></div>
          <!-- <p class="card-text">{{i.product_desc}}</p> -->
          <div class="d1">
          <span id="divpr{{i.id}}" class="divpr"></span>
       
          <div id="davpr{{i.id}}" class="divpr davpr">
           <button id="dltpr{{i.id}}" class="dlttemp" style="display: none;"><img src="/static/trash1.png" alt="Ni" id="dltimgpr{{i.id}}" class="cdb" onclick="deleteitemc(this.id)"></button>
          
            <button id="pr{{i.id}}" class="cart">
              <a href="#" id="atc" class="btn btn-primary" onclick="return false;">Add to Cart</a>
            </button></div>
          
          
  
            <div id="dovpr{{i.id}}" class="divpr dovpr" style="display: none;">
              <button id="minuspr{{i.id}}" class="mm minus  btn btn-success">- </button>
               <span class="mmval" id="valpr{{i.id}}"></span>
              <button id="pluspr{{i.id}}" class=" plus  btn btn-success mm">+ </button>
                
             </div>
            </div></div>
  
            
        </div>
      </div>
      {% endfor %}
    </div>


<div class="items" style="display: none;">
  
    {% for i in all %}

    <div class="card m-3 nowcard" style="width: 18rem">
      <a href="/products/{{i.id}}">
        <div class="pimg">
        <!-- <img src=" /media/{{i.image}}" class="card-img-top prodi" alt="img not found"  />--> </div>
    
    </a>
      <div class="card-body">
        <div class="dd">
      
        <div class="d2">   
        
          

<h5 id="jnamepr{{i.id}}" class="jname" style="display: flex;"></h5>
<h5 class="card-title" id="namepr{{i.id}}" style="display: none;">{{i.product_name}}</h5>
        <h5 class="card-title jpr" id="pricepr{{i.id}}">&#8377 {{i.price}}</h5></div>
        <!-- <p class="card-text">{{i.product_desc}}</p> -->
        <div class="d1">
        <span id="divpr{{i.id}}" class="divpr"></span>
     
        <div id="davpr{{i.id}}" class="divpr davpr">
         <button id="dltpr{{i.id}}" class="dlttemp" style="display: none;"><img src="/static/trash1.png" alt="Ni" id="dltimgpr{{i.id}}" class="cdb" onclick="deleteitemc(this.id)"></button>
        
          <button id="pr{{i.id}}" class="cart">
            <a href="#" id="atc" class="btn btn-primary" onclick="return false;">Add to Cart</a>
          </button></div>
        
        

          <div id="dovpr{{i.id}}" class="divpr dovpr" style="display: none;">
            <button id="minuspr{{i.id}}" class="mm minus  btn btn-success">- </button>
             <span class="mmval" id="valpr{{i.id}}"></span>
            <button id="pluspr{{i.id}}" class=" plus  btn btn-success mm">+ </button>
              
           </div>
          </div></div>

          
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="incart">
   

<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasRightLabel">Cart</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body" id="ocbody">

    <p class="occe" id="occee">
      Cart empty
    </p>
    
  </div>
  <div class="buutons">
    <button class="ccbtns btn btn-primary"  id="clearcart">Clear</button>
    <button class="ccbtns btn btn-primary" disabled="disabled" id="checkout" onclick="location.href = '/Checkout';">Checkout</button>
  </div>
</div>
  </div>

</div>
{% endblock body %} {% block js %}
<script>
//searchtitle

document.getElementById('searchtitle').innerHTML='{{query}}'

//scroller
const productContainers = [...document.querySelectorAll('.product-container')];
const nxtBtn = [...document.querySelectorAll('.nxt-btn')];
const preBtn = [...document.querySelectorAll('.pre-btn')];

productContainers.forEach((item, i) => {
    let containerDimensions = item.getBoundingClientRect();
    let containerWidth = containerDimensions.width;

    nxtBtn[i].addEventListener('click', () => {
        item.scrollLeft += containerWidth;
    })

    preBtn[i].addEventListener('click', () => {
        item.scrollLeft -= containerWidth;
    })
})

  if (localStorage.getItem("cart") == null) {
    var cart = {};
  } else {
    cart = JSON.parse(localStorage.getItem("cart"));
    // document.getElementById("cb").innerHTML = Object.keys(cart).length;
    // updatecart(cart);
  }


  $(".cart").click(function () {
    

    var idstr = this.id.toString();
    console.log(idstr)

    if (cart[idstr] != undefined) {
      qty = cart[idstr][0] + 1;
      cart[idstr][0]=qty;
      
      // cart[idstr] = [qty,naam,price]; 
    } else { 
      qty=1;
     
      naam=document.getElementById('name'+idstr).innerHTML;
      price=document.getElementById('price'+idstr).innerHTML;
      price=price.slice(2,);
      
      cart[idstr] = [qty,naam,price];
    }

    
    updatecart(cart, this.id);
  });

  //carousel nu search

  function catsearch(category){
    console.log(category)
    document.getElementById('search').value=category;
    document.getElementById('searchsubmit').click();

  }

//bill 
  

  function updatecart(cart, idd) {
    var sum=0;
    for(var item in cart)
    sum=sum+cart[item][0];
    document.getElementById("val"+idd).innerHTML=cart[idd][0];
    document.getElementById("dov"+idd).style.display='block';
     document.getElementById("dav"+idd).style.display='none';
    //  document.querySelectorAll("#dov"+idd).forEach(a=>a.style.display = "block");
    // document.querySelectorAll("#dav"+idd).forEach(a=>a.style.display = "none");

localStorage.setItem("cart", JSON.stringify(cart));
    document.getElementById("cartbuttontext").innerHTML = sum;
    if (sum==0) {
      document.getElementById("cartbuttontext").innerHTML="";

    }
  
  }

  // clear cartbutton
  document.getElementById("clearcart").addEventListener("click",function(){
    
    localStorage.clear();
   
    cart={};
    localStorage.setItem("cart", JSON.stringify(cart));
    
    document.getElementById("ocbody").innerHTML="<p >Cart empty</p>";
    
    document.getElementById("cartbuttontext").innerHTML="";
    $('.dovpr').css("display", "none");
    $('.davpr').css("display", "block");
    document.getElementById('clearcart').disabled=true;
document.getElementById('checkout').disabled=true;
  });

  document.getElementById("cartbutton").addEventListener("click", function(){
    console.log("cinc")
    var summ=0;
    for(var item in cart)
    summ=summ+cart[item][0];
if(summ==0){
document.getElementById('clearcart').disabled=true;
document.getElementById('checkout').disabled=true;
}else{
  document.getElementById('clearcart').disabled=false;
document.getElementById('checkout').disabled=false;


var popstr="";
// console.log(popstr);
var i=1;
for (var item in cart){
  if(cart[item][0]==0)
  continue;
  popstr=popstr+'<div class="fd" id="g'+item+'" ><div class="ocdiv1"> <b>'+""+'</b><div class="ocdiv"> ';
  popstr=popstr+'<p class="ocbodyitems">' +document.getElementById('sname'+item).innerHTML.slice(0,20)+ '</p><p class="ocbq">'+"...  x <b>"+cart[item][0]+` </p></b> </div></div>`;
 
  let bus=document.getElementById('dlt'+item).innerHTML;
popstr=popstr+bus+'</div></div>';
  i=i+1;

}
// console.log(popstr);
document.getElementById("ocbody").innerHTML=popstr;


}
});

  $('.divpr').on("click", "button.minus", function() {
    a=this.id.slice(5, );
  
   cart[a][0]=cart[a][0]-1;
  //  console.log(cart[a]);
   document.getElementById("val"+a).innerHTML=cart[a][0];
   updatecart(cart,a);
  if(cart[a][0]<1){
    
 

    
    document.getElementById("dov"+a).style.display='none';
    document.getElementById("dav"+a).style.display='block';
  }
});
  $('.divpr').on("click", "button.plus", function() {
    a=this.id.slice(4, );
   
   cart[a][0]=cart[a][0]+1;
   document.getElementById("val"+a).innerHTML=cart[a][0];
   updatecart(cart,a);

});
let asam;
{% for i in products%}
asam=document.getElementById('namepr'+{{i.id}}).innerHTML;
if(asam.length>9){
  document.getElementById('jnamepr'+{{i.id}}).innerHTML=asam.slice(0,9)+'...'; 
}else{
  document.getElementById('jnamepr'+{{i.id}}).innerHTML=asam;
}
{% endfor%}

function deleteitemc(bid){
 
  a=bid.slice(6,)
  console.log(a)

  cart[a][0]=0;
  updatecart(cart,a);
  document.getElementById("dov"+a).style.display='none';
    document.getElementById("dav"+a).style.display='block';
  // localStorage.removeItem("cart",delete cart.a)
document.getElementById('g'+a).remove();

if(document.getElementById('cartbuttontext').innerHTML==""){
  document.getElementById('ocbody').innerHTML=`<p class="occe" id="occee">
      Cart empty
    </p>`
}

}
window.onload = function() {
 sum=0;
  console.log('onload')
  for(var item in cart)
    sum=sum+cart[item][0];
    document.getElementById("cartbuttontext").innerHTML = sum;
    if (sum==0) {
      document.getElementById("cartbuttontext").innerHTML="";

    }
}
</script>
{% endblock js %}
